% !TEX encoding = UTF-8 Unicode 
% !TEX root = on_gates.tex

\clearpage

\section{2-Level Unitary gates}

A 2-level unitary is a unitary operation that acts non-trivially on only 2-states. For 2-qubits, any controlled-unitary gate is 2-level,
\[
\begin{bsmallmatrix}
    1 & 0 & 0 & 0 \\ 
    0 & 1 & 0 & 0 \\ 
    0 & 0 & a & c \\ 
    0 & 0 & b & d        
\end{bsmallmatrix}
\]
where the 2x2 submatrix $\begin{bsmallmatrix}
    a & c \\ 
    b & d        
\end{bsmallmatrix}$ 
is unitary. But the active states need not be the last two. Any permutation of a controlled 1-qubit gate is also a two-level unitary, such as 
\[
\begin{bsmallmatrix}
    a & c & 0 & 0 \\ 
    b & d & 0 & 0 \\ 
    0 & 0 & 1 & 0 \\ 
    0 & 0 & 0 & 1        
\end{bsmallmatrix}
\text{or}
\begin{bsmallmatrix}
    a & 0 & 0 & c \\ 
    0 & 1 & 0 & 0 \\ 
    0 & 0 & 1 & 0 \\ 
    b & 0 & 0 & d        
\end{bsmallmatrix} \ .
\]
Similarly any multi-controlled 2x2 unitary, or permutation of the same, is a 2-level unitary. 

Two-level unitaries are important because we can systematically decompose an arbitrary unitary into a sequence of 2-level unitaries, and 2-level unitaries themselves can be decomposed into controlled-unitary gates. 

% Cite Reck1994

\subsection{Two-level unitary decomposition}

A $d$-dimensional unitary operator can be decomposed into a product of, at most, $\half d(d-1)$ 2-level unitaries~\cite{Reck1994a,???,???}.

We'll use a 2-qubit gate $A$ as illustration, with dimension $d=2^2=4$. 
\[
A = \begin{bsmallmatrix}
    a_{00} & a_{01} & a_{02} & a_{03} \\ 
    a_{10} & a_{11} & a_{12} & a_{13} \\
    a_{20} & a_{21} & a_{22} & a_{23} \\    
    a_{30} & a_{31} & a_{32} & a_{33}    
    \end{bsmallmatrix}
\]
The trick is that we can set any off-diagonal entry to zero by multiply by a carefully constructed 2-level unitary. Lets start with the $(1,0)$ entry.
\[
B = U_{10} A = \begin{bsmallmatrix}
    1 & b_{01} & b_{02} & b_{03} \\ 
    0 & b_{11} & b_{12} & b_{13} \\
    b_{20} & b_{21} & b_{22} & b_{23} \\    
    b_{30} & b_{31} & b_{32} & b_{33}    
    \end{bsmallmatrix}
    \  \quad
 	U_{10} = \begin{bsmallmatrix}
    \tfrac{a^*_{00}}{w} & \tfrac{a^*_{10}}{w} & 0 & 0 \\ 
    \tfrac{a_{10}}{w} & \tfrac{-a_{00}}{w} & 0 & 0 \\
    0 & 0 & 1 & 0 \\    
    0 & 0 & 0 & 1    
    \end{bsmallmatrix}
\  \quad w = \sqrt{|a_{00}| + |a_{10}|}
\notag
\]
Following through the matrix multiplication, we see that $b_{10} = (a_{10}a_{00} - a_{00}a_{10})/w = 0$, and $b_{00} = 
 (a^*_{00}a_{00} - a^*_{10}a_{10})/w = w/w= 1$

We can now set $(2,0)$ to zero using the same procedure, 
\[
C = U_{20} B = \begin{bsmallmatrix}
    1 & c_{01} & c_{02} & c_{03} \\ 
    0 & c_{11} & c_{12} & c_{13} \\
    0 & c_{21} & c_{22} & c_{23} \\    
    c_{30} & c_{31} & c_{32} & c_{33}    
    \end{bsmallmatrix}
    \  \quad
 	U_{20} = \begin{bsmallmatrix}
    \tfrac{b^*_{00}}{w} & 0 & \tfrac{b^*_{20}}{w} & 0\\ 
    0 & 1 & 0 & 0 \\     
    \tfrac{b_{20}}{w} & 0 & \tfrac{-b_{00}}{w} & 0 \\   
    0 & 0 & 0 & 1    
    \end{bsmallmatrix}
\  \quad w = \sqrt{|b_{00}| + |b_{20}|}
\notag
\]
and then set $(3,0)$ to zero. 
\[
D = U_{30} C = \begin{bsmallmatrix}
    1 & 0 & 0 & 0 \\ 
    0 & d_{11} & d_{12} & d_{13} \\
    0 & d_{21} & d_{22} & d_{23} \\    
    0 & d_{31} & d_{32} & d_{33}    
    \end{bsmallmatrix}
    \  \quad
 	U_{30} = \begin{bsmallmatrix}
    \tfrac{c^*_{00}}{w} & 0 & 0 & \tfrac{c^*_{20}}{w}\\ 
    0 & 1 & 0 & 0 \\      
    0 & 0 & 1 & 0 \\   
    \tfrac{c_{20}}{w} & 0 & 0 & \tfrac{-c_{00}}{w}
    \end{bsmallmatrix}
\  \quad w = \sqrt{|c_{00}| + |c_{20}|}
\notag
\]
Once we have set all the off diagonal elements of the left column to zero, then the off-diagonal elements of the top row must also be zero because ... \todo{TODO}

Once we repeat this procedure $\half d(d-1)$ times, setting all the lower off-diagonal entries to zero,  we are left with the identity matrix.
\[
I = U_{32} U_{31} U_{21} U_{30} U_{20} U_{10} A
\]
Inverting this circuit, we obtain the original unitary as a product of 2-level unitaries. 
\[
A = U^{\dagger}_{10} U^{\dagger}_{20} U^{\dagger}_{30} U^{\dagger}_{21} U^{\dagger}_{31} U^{\dagger}_{32}
\]

\subsection{Control-gate decomposition of 2-level unitary}




